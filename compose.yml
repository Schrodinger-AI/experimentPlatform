version: '3.7'
services:
  rq-dashboard:
    image: dogforever442/rq-docker
    command: rq-dashboard -H rq-server
    ports:
      - 9181:9181

  rq-worker:
    image: dogforever442/rq-docker
    command: rq worker -u redis://rq-server:6379 high normal low
    deploy:
      replicas: 3

  rq-server:
    image: redis:alpine
    ports:
      - 6379:6379

  backend:
    image: dogforever442/experiment-platform-backend
    ports:
      - 8000:8000
    environment:
      - OPENAI_API_KEY=<yourapikey>

  frontend:
    image: dogforever442/experiment-platform-frontend
    ports:
      - 80:80